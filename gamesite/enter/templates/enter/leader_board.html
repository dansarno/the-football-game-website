{% extends "feed/base.html" %}
{% load humanize %}

{% block content %}

{% include 'feed/profile_sidebar.html'%}

<div class="col-9 mt-4">
<h2>Leader Boards</h2>

<div class="card border-light shadow-sm mb-4">
  <div class="card-body">
    <div id="table_container" url-endpoint="{% url 'enter:all_entries_api' %}">
      <h3>Overall Leader Board</h3>
        <hr />
      <table id="overall_leader_board" class="display" style="width:100%">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Username</th>
                    <th>Entry ID</th>
                    <th>Score</th>
                    <th>Position</th>
                    <th>Team</th>
                </tr>
            </thead>
        </table>
    </div>
    </div>
  </div>
</div>

<script>
  $(document).ready(function() {
    var tableDataEndpoint = $( "#table_container" ).attr( "url-endpoint" )

    $.ajax({
            method: "GET",
            url: tableDataEndpoint,
            success: function(entries) {
              console.log(entries);
              $('#overall_leader_board').DataTable( {
                  data: entries,
                  columns: [
                      { data: "profile",
                        render: function ( data, type, row ) {
                            return `${data.user.first_name} ${data.user.last_name}`;
                            }
                      },
                      { data: "profile.user.username" },
                      { data: "id" },
                      { data: "current_score" },
                      { data: "current_position" },
                      { data: "team" },
                  ],
                  "columnDefs": [{
                      "targets": '_all',
                      "defaultContent": "-"
                  }],
              } );
            }
          })
  } );
</script>

{% endblock content %}